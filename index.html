<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ACG Store</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vant@2.12/lib/index.css" />
</head>

<body>
    <div id="app">
        <van-tabs @click="onTabClick">
            <van-tab title="漫画">
                <iframe ref="comic_iframe" frameborder="0" width="100%" scrolling="no" src="/漫画/index.html"></iframe>
            </van-tab>
            <van-tab title="动漫">
                <iframe ref="anime_iframe" frameborder="0" width="100%" scrolling="no" src="/动漫/index.html"></iframe>
            </van-tab>
            <van-tab title="阅读">
                <iframe ref="novel_iframe" frameborder="0" width="100%" scrolling="no" src="/阅读/index.html"></iframe>
            </van-tab>
            <van-tab title="有声">
                <iframe ref="audio_iframe" frameborder="0" width="100%" scrolling="no" src="/有声/index.html"></iframe>
            </van-tab>
        </van-tabs>
    </div>
    <!-- 引入 Vue 和 Vant 的 JS 文件 -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6/dist/vue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vant@2.12/lib/vant.min.js"></script>
    <script>
        // 在 #app 标签下渲染一个按钮组件
        new Vue({
            el: '#app',
            data() {
                return {
                    windowWidth: document.documentElement.clientWidth,  //实时屏幕宽度
                    windowHeight: document.documentElement.clientHeight,   //实时屏幕高度
                }
            },
            mounted() {
                var that = this;
                setTimeout(function () {
                    that.resetHeight(that.$refs.comic_iframe);
                }, 800);

                window.onresize = () => {
                    return (() => {
                        window.fullHeight = document.documentElement.clientHeight;
                        window.fullWidth = document.documentElement.clientWidth;
                        that.windowHeight = window.fullHeight;
                        that.windowWidth = window.fullWidth;
                    })()
                };
            },
            methods: {
                onTabClick(name, title) {
                    var that = this;
                    switch (title) {
                        case "漫画":
                            setTimeout(function () {
                                that.resetHeight(that.$refs.comic_iframe);
                            }, 300);
                            break;
                        case "动漫":
                            setTimeout(function () {
                                that.resetHeight(that.$refs.anime_iframe);
                            }, 300);
                            break;
                        case "阅读":
                            setTimeout(function () {
                                that.resetHeight(that.$refs.novel_iframe);
                            }, 300);
                            break;
                        case "有声":
                            setTimeout(function () {
                                that.resetHeight(that.$refs.audio_iframe);
                            }, 300);
                            break;
                    }
                },
                resetHeight(iframe) {
                    var _wh = document.documentElement.clientHeight - 130;//浏览器中间数据展示区域高度
                    var h = 0;
                    try {
                        var a = iframe.contentWindow.document.body.scrollHeight;
                        var b = iframe.contentWindow.document.documentElement.scrollHeight;
                        h = a > b ? a : b;
                        h += 150;
                    } catch (e) { }
                    //如果没有读到，那就使用默认的浏览器中间数据展示区域的高度
                    if (!h || h < _wh) {
                        h = _wh;
                    }
                    iframe.style.height = h + 'px';
                }
            }
        })
        Vue.use(vant.Lazyload)
    </script>
</body>

</html>